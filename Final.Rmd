---
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE)
```


```{r}
setwd(getwd())

library(readxl)
loss <- read_excel("./ex11-53cheese.xls")

taste = loss$taste
acetic = loss$acetic
h2s = loss$h2s
lactic = loss$lactic

```

# 11.53

### Taste  
Mean = `r mean(taste)`  
Median = `r median(taste)`  
Standard deviation = `r sd(taste)`  
Interquartile range = `r IQR(taste)`  

```{r out.width="50%"}
stem(taste)
qqnorm(taste, pch = 1, frame = FALSE)
qqline(taste, col = "steelblue", lwd = 2)
```

The normal QQ plot shows a roughly straight line and the leaf plot looks skewed right.  

### Acetic
Mean = `r mean(acetic)`   
Median = `r median(acetic)`  
Standard deviation = `r sd(acetic)`  
Interquartile range = `r IQR(acetic)`  
```{r out.width = "50%"}
stem(acetic)
qqnorm(acetic, pch = 1, frame = FALSE)
qqline(acetic, col = "steelblue", lwd = 2)
```

The normal QQ plot shows a roughly straight line but the leaf plot does not look normal.


### H2S
Mean = `r mean(h2s)`   
Median = `r median(h2s)`  
Standard deviation = `r sd(h2s)`  
Interquartile range = `r IQR(h2s)`  
```{r out.width = "50%"}
stem(h2s)
qqnorm(h2s, pch = 1, frame = FALSE)
qqline(h2s, col = "steelblue", lwd = 2)
```

The normal QQ plot shows a roughly straight line but the leaf plot is skewed right. 



### Lactic
Mean = `r mean(lactic)`   
Median = `r median(lactic)`  
Standard deviation = `r sd(lactic)`  
Interquartile range = `r IQR(lactic)`  
```{r out.width = "50%"}
stem(lactic)
qqnorm(lactic, pch = 1, frame = FALSE)
qqline(lactic, col = "steelblue", lwd = 2)
```

The normal QQ plot shows a roughly straight line but the leaf plot is approximately normal.

In summary, taste, acetic, and H2S do not seem to be normally distributed, but lactic does.  





# 11.54

```{r out.width = "50%"}
plot(taste, acetic)
res = summary(aov(taste~acetic))
```

The relationship between taste and acetic is positive.  
Correlation = `r cor(taste, acetic)`  
P-value = `r res[[1]][["Pr(>F)"]][1]`  

```{r out.width = "50%"}
plot(taste, h2s)
res = summary(aov(taste~h2s))
```

The relationship between taste and h2s is positive.  
Correlation = `r cor(taste, h2s)`  
P-value = `r res[[1]][["Pr(>F)"]][1]`  

```{r out.width = "50%"}
plot(taste, lactic)
res = summary(aov(taste~lactic))
```

The relationship between taste and lactic is positive.  
Correlation = `r cor(taste, lactic)`  
P-value = `r res[[1]][["Pr(>F)"]][1]`  

```{r out.width = "50%"}
plot(acetic, h2s)
res = summary(aov(acetic~h2s))
```

The relationship between acetic and h2s is positive.  
Correlation = `r cor(acetic, h2s)`  
P-value = `r res[[1]][["Pr(>F)"]][1]`  

```{r out.width = "50%"}
plot(acetic, lactic)
res = summary(aov(acetic~lactic))
```

The relationship between acetic and lactic is positive.  
Correlation = `r cor(acetic, lactic)`  
P-value = `r res[[1]][["Pr(>F)"]][1]`  

```{r out.width = "50%"}
plot(h2s, lactic)
res = summary(aov(h2s~lactic))
```

The relationship between h2s and lactic is positive.  
Correlation = `r cor(h2s, lactic)`  
P-value = `r res[[1]][["Pr(>F)"]][1]`  







# 11.55
```{r}
tamodel <- lm(taste ~ acetic, data = loss)
modelSummary <- summary(tamodel)
modelCoeffs <- modelSummary$coefficients
beta <- modelCoeffs["acetic", "Estimate"]
se <- modelCoeffs["acetic", "Std. Error"]
t_value <- beta/se
p_value <- 2*pt(-abs(t_value), df=nrow(loss) - 2)
```
Taste = `r tamodel$coefficients["(Intercept)"]` + `r tamodel$coefficients["acetic"]` * Acetic  
T-value: `r t_value`  
P-value: `r p_value`  

```{r out.width = "50%"}
Taste_Acetic <- lm(taste ~ acetic, data = loss)
modelSummary <- summary(Taste_Acetic)
hist(Taste_Acetic$residuals, pch = 16, col = "red", main = "Histogram of Residuals")

predictedy <- Taste_Acetic$fitted.values
plot(acetic,taste)
#lines(acetic, predictedy)
```

# 11.56
# 11.57
# 11.58
# 11.59
# 11.60
# 11.61




